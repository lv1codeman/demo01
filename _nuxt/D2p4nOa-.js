import{k as j,p as q,z as Y,q as F,x as d,D as N,a7 as K,L as I,a5 as H,a8 as X,E as _,a9 as J,r as Q,aa as Z,K as ee,i as te,b as l,a as m,v as z,R as ae,_ as se,e as ne,ab as le,c as oe,w as c,n as re,o as ue,d as D}from"#entry";import{V as ie,a as ce,b as de,c as ve,d as O,e as M}from"./ksjuoi93.js";import{b as me,h as fe,m as pe,c as ge,i as ye,j as B,k as Te,e as xe,V as G}from"./xAmUT8md.js";import{V as Ve}from"./DBlEawy9.js";import{V as be,u as ke}from"./D3DxaS4S.js";import{e as he,u as Ee,f as we,V as $}from"./B6_3Jv6i.js";import{j as Pe,u as Se,e as Ce,g as _e,a as Le}from"./D8QlKonl.js";function Ae(t){const i=N(t());let r=-1;function s(){clearInterval(r)}function f(){s(),ee(()=>i.value=t())}function k(T){const x=T?getComputedStyle(T):{transitionDuration:.2},V=parseFloat(x.transitionDuration)*1e3||200;if(s(),i.value<=0)return;const b=performance.now();r=window.setInterval(()=>{const y=performance.now()-b+V;i.value=Math.max(t()-y,0),i.value<=0&&s()},V)}return Z(s),{clear:s,time:i,start:k,reset:f}}const Re=q({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...ge({location:"bottom"}),...pe(),...we(),...Ce(),...Q(),...J(ye({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy","stickToTarget"])},"VSnackbar"),De=j()({name:"VSnackbar",props:Re(),emits:{"update:modelValue":t=>!0},setup(t,i){let{slots:r}=i;const s=Y(t,"modelValue"),{positionClasses:f}=me(t),{scopeId:k}=Pe(),{themeClasses:T}=F(t),{colorClasses:x,colorStyles:V,variantClasses:b}=Se(t),{roundedClasses:y}=he(t),p=Ae(()=>Number(t.timeout)),w=d(),L=d(),h=N(!1),A=N(0),P=d(),R=te(be,void 0);K(()=>!!R,()=>{const u=ke();ae(()=>{P.value=u.mainStyles.value})}),I(s,E),I(()=>t.timeout,E),H(()=>{s.value&&E()});let S=-1;function E(){p.reset(),window.clearTimeout(S);const u=Number(t.timeout);if(!s.value||u===-1)return;const C=X(L.value);p.start(C),S=window.setTimeout(()=>{s.value=!1},u)}function a(){p.reset(),window.clearTimeout(S)}function e(){h.value=!0,a()}function n(){h.value=!1,E()}function v(u){A.value=u.touches[0].clientY}function g(u){Math.abs(A.value-u.changedTouches[0].clientY)>50&&(s.value=!1)}function o(){h.value&&n()}const U=_(()=>t.location.split(" ").reduce((u,C)=>(u[`v-snackbar--${C}`]=!0,u),{}));return Ee(()=>{const u=B.filterProps(t),C=!!(r.default||r.text||t.text);return l(B,z({ref:w,class:["v-snackbar",{"v-snackbar--active":s.value,"v-snackbar--multi-line":t.multiLine&&!t.vertical,"v-snackbar--timer":!!t.timer,"v-snackbar--vertical":t.vertical},U.value,f.value,t.class],style:[P.value,t.style]},u,{modelValue:s.value,"onUpdate:modelValue":W=>s.value=W,contentProps:z({class:["v-snackbar__wrapper",T.value,x.value,y.value,b.value],style:[V.value],onPointerenter:e,onPointerleave:n},u.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0,onTouchstartPassive:v,onTouchend:g,onAfterLeave:o},k),{default:()=>[_e(!1,"v-snackbar"),t.timer&&!h.value&&m("div",{key:"timer",class:"v-snackbar__timer"},[l(Te,{ref:L,color:typeof t.timer=="string"?t.timer:"info",max:t.timeout,modelValue:p.time.value},null)]),C&&m("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[r.text?.()??t.text,r.default?.()]),r.actions&&l(Le,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[m("div",{class:"v-snackbar__actions"},[r.actions({isActive:s})])]})],activator:r.activator})}),fe({},w)}}),Oe={class:"conditional-area d-flex align-center"},Ne={class:"d-flex flex-column ga-5"},Ie={__name:"ClassConverter114",setup(t){const i=d([]),r=d([]),s=d(""),f=d(""),k=d(null),T=d(null),x=d("系所簡稱"),V=["系所簡稱","系所全名","學院簡稱","學院全名","系辦助理","系辦助理分機","系辦助理Email","課務承辦人","課務承辦人分機","課務承辦人Email"],b=d(!1);let y=null,p=null;const{$curridataAPI:w}=ne(),L=a=>{a.preventDefault();const e=a.clipboardData.getData("text");s.value=e.trim()},h=()=>{s.value="",f.value=""},A=async()=>{try{if(!navigator.clipboard){alert("你的瀏覽器不支援剪貼簿功能，請手動複製。");return}await navigator.clipboard.writeText(f.value),b.value=!0}catch(a){console.error("複製失敗:",a),alert("複製失敗，請手動複製。")}};H(async()=>{try{const[n,v]=await Promise.all([w.get("/classdeptshort"),w.get("/deptlist")]);i.value=n.data,r.value=v.data,console.log("資料已成功載入")}catch(n){console.error("載入資料失敗:",n)}const a=k.value?.$el.querySelector("textarea"),e=T.value?.$el.querySelector("textarea");if(a&&e){const n=o=>{o.target===a?e.scrollTop=a.scrollTop:o.target===e&&(a.scrollTop=e.scrollTop)};a.addEventListener("scroll",n),e.addEventListener("scroll",n);const v=()=>{e.style.height=`${a.offsetHeight}px`,e.style.width=`${a.offsetWidth}px`},g=()=>{a.style.height=`${e.offsetHeight}px`,a.style.width=`${e.offsetWidth}px`};y=new ResizeObserver(v),p=new ResizeObserver(g),y.observe(a),p.observe(e)}}),le(()=>{y&&y.disconnect(),p&&p.disconnect()});const P=_(()=>{const a=new Map;return i.value&&i.value.forEach(e=>{a.set(e.CLASS,e.DEPTSHORT)}),a}),R=_(()=>{const a=new Map;return r.value&&r.value.forEach(e=>{a.set(e.DEPTSHORT,e)}),a}),S=_(()=>!s.value||!P.value.size||!R.value.size?"":s.value.split(`
`).map(n=>{const v=n.trim(),g=P.value.get(v);if(!g)return"查無班級";const o=R.value.get(g);if(!o)return"查無系所資料";switch(x.value){case"系所簡稱":return o.DEPTSHORT;case"系所全名":return o.DEPT;case"學院簡稱":return o.COLLEGESHORT;case"學院全名":return o.COLLEGE;case"系辦助理":return o.AGENT;case"系辦助理分機":return o.AGENTEXT;case"系辦助理Email":return o.AGENTEMAIL;case"課務承辦人":return o.CAGENT;case"課務承辦人分機":return o.CAGENTEXT;case"課務承辦人Email":return o.CAGENTEMAIL;default:return"無效選項"}}).join(`
`));I(S,a=>{f.value=a});const E=_(()=>V.reduce((v,g)=>v.length>g.length?v:g,"").length*10+80);return(a,e)=>(ue(),oe("div",null,[e[8]||(e[8]=m("h1",null,"班級轉換(114以後)",-1)),l(ie,{class:"mt-4 w-50"},{default:c(()=>[l(ce,{title:"使用教學"},{default:c(()=>[l(de,null,{default:c(()=>[...e[4]||(e[4]=[m("ul",null,[m("li",null," 在左輸入框貼上從Excel複製的班級簡稱，右邊輸入框會自動產出結果。 "),m("li",null,"貼上後想看不同結果可選擇下拉選項"),m("li",null,"可將結果複製貼回Excel中使用。")],-1)])]),_:1})]),_:1})]),_:1}),m("div",Oe,[l(xe,{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=n=>x.value=n),class:"function-selector mt-4",items:V,label:"功能選擇",style:re({maxWidth:`${E.value}px`}),density:"comfortable"},null,8,["modelValue","style"])]),l(Ve,{id:"mpage",class:"px-0"},{default:c(()=>[l(ve,{"no-gutters":"",class:"align-center"},{default:c(()=>[l(O,{cols:"auto"},{default:c(()=>[l(M,{ref_key:"inputRef",ref:k,modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=n=>s.value=n),class:"resizable-textarea text-right",label:"輸入框",onPaste:L},null,8,["modelValue"])]),_:1}),l(O,{cols:"auto",class:"px-2 pb-5"},{default:c(()=>[m("div",Ne,[l(G,{color:"green-lighten-3 text-grey-darken-4",onClick:A},{default:c(()=>[e[5]||(e[5]=D(" Copy ",-1)),l($,{icon:"mdi-content-copy",end:""})]),_:1}),l(G,{color:"blue-lighten-3 text-grey-darken-4",onClick:h},{default:c(()=>[e[6]||(e[6]=D(" Clear ",-1)),l($,{icon:"mdi-close-circle-outline",end:""})]),_:1})])]),_:1}),l(O,{cols:"auto"},{default:c(()=>[l(M,{ref_key:"outputRef",ref:T,modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=n=>f.value=n),class:"resizable-textarea",label:"輸出框"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(De,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=n=>b.value=n),timeout:2e3,color:"success",location:"bottom right"},{default:c(()=>[...e[7]||(e[7]=[D(" 已複製到剪貼簿 ",-1)])]),_:1},8,["modelValue"])]))}},We=se(Ie,[["__scopeId","data-v-8fafe373"]]);export{We as default};
