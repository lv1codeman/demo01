import{D as c}from"./BWrkSfih.js";import{e as A,r as s,l as y,m as G,k as N,c as m,b as C,o as f}from"#entry";import"./DSUDakof.js";import"./CJn3Air_.js";import"./B40JzDP1.js";import"./oUUxz8iw.js";const D={__name:"DBmaintain",setup(b){const{$curridataAPI:n}=A(),E=s(null);y({});const r=s([]),i=[{value:"ID",title:"ID",sortable:!1,width:"0px",class:"d-none",cellClass:"d-none"},{value:"COLLEGE",title:"學院全名"},{value:"COLLEGESHORT",title:"學院簡稱"},{value:"DEPTSHORT",title:"系所簡稱"},{value:"DEPT",title:"系所全名"},{value:"STYPE",title:"學制"},{value:"AGENT",title:"承辦人"},{value:"AGENTEXT",title:"承辦人分機"},{value:"AGENTEMAIL",title:"承辦人Email"},{value:"CAGENT",title:"課務承辦人"},{value:"CAGENTEXT",title:"課務承辦人分機"},{value:"CAGENTEMAIL",title:"課務承辦人Email"},{value:"actions",title:"操作",sortable:!1}],d={get:"/get_deptlist",add:"/add_dept",update:"/update_dept",delete:"/delete_dept/{id}"},l=e=>!!e||"此欄位為必填。",o=async()=>{try{const e=await n.get("/get_cagent");r.value=e.data}catch(e){console.error("無法從 API 取得課務承辦人資料。",e)}},u=e=>{if(e.CAGENT){const t=r.value.find(a=>a.NAME===e.CAGENT);t&&(e.CAGENT=t,e.CAGENTEXT=t.EXT,e.CAGENTEMAIL=t.EMAIL)}},p=({key:e,value:t})=>{if(e==="CAGENT"&&t){const a=E.value.editedItem;a.CAGENT=t,a.CAGENTEXT=t.EXT,a.CAGENTEMAIL=t.EMAIL}},T=G(()=>[{key:"COLLEGE",label:"學院全名",type:"text",rules:[l]},{key:"COLLEGESHORT",label:"學院簡稱",type:"text",rules:[l]},{key:"DEPTSHORT",label:"系所簡稱",type:"text",rules:[l]},{key:"DEPT",label:"系所全名",type:"text",rules:[l]},{key:"STYPE",label:"學制",type:"text",rules:[l]},{key:"AGENT",label:"承辦人",type:"text",rules:[l]},{key:"AGENTEXT",label:"承辦人分機",type:"text",rules:[l]},{key:"AGENTEMAIL",label:"承辦人Email",type:"text",rules:[l]},{key:"CAGENT",label:"課務承辦人",type:"select",rules:[l],items:r.value,"item-title":"NAME","return-object":!0},{key:"CAGENTEXT",label:"課務承辦人分機",type:"text",readonly:!0},{key:"CAGENTEMAIL",label:"課務承辦人Email",type:"text",readonly:!0}]);return N(()=>{o()}),(e,t)=>(f(),m("div",null,[C(c,{ref_key:"dtCrudRef",ref:E,title:"系所表維護",tableTitle:"系所表",headers:i,apiUrl:"",apiEndpoints:d,formFields:T.value,itemSingular:"系所",onOnEdit:u,onFieldUpdated:p},null,8,["formFields"])]))}};export{D as default};
